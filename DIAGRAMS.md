# ðŸ“Š Diagramas del Sistema - Proyecto Albergue

Visualizaciones grÃ¡ficas de arquitectura, flujos y comportamiento del sistema.

## ðŸ“‹ Tabla de Contenidos

1. [Diagrama de Arquitectura](#diagrama-de-arquitectura)
2. [Diagrama de Secuencia](#diagrama-de-secuencia)
3. [Diagrama de Flujo](#diagrama-de-flujo)
4. [Diagrama de Componentes](#diagrama-de-componentes)
5. [Diagrama de Estados](#diagrama-de-estados)
6. [Diagrama ER de Datos](#diagrama-er-de-datos)
7. [Diagrama de Despliegue](#diagrama-de-despliegue)

## ðŸ›ï¸ Diagrama de Arquitectura

### Vista General del Sistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      USUARIOS                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Gestor Albergue  â”‚                    â”‚  Repartidor            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  App Albergue        â”‚  â”‚  App Repartidor    â”‚
â”‚  (React Native)      â”‚  â”‚  (React Native)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - React Layer       â”‚  â”‚  - React Layer     â”‚
â”‚  - WebView (Leaflet) â”‚  â”‚  - WebView (Map)   â”‚
â”‚  - MQTT Client       â”‚  â”‚  - MQTT Client     â”‚
â”‚  - Location API      â”‚  â”‚  - Location API    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚
        â”‚   WebSocket         â”‚
        â”‚  (Port 9001)        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   MQTT Broker       â”‚
        â”‚   (Mosquitto)       â”‚
        â”‚  192.168.1.137:9001 â”‚
        â”‚                     â”‚
        â”‚  Topics:            â”‚
        â”‚  - paquetes/posicionâ”‚
        â”‚  - paquetes/ruta    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”
    â”‚OpenStreetMap â”‚ Leaflet JS  â”‚
    â”‚(Map Tiles)   â”‚ (Chart Lib) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Capas de Arquitectura

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PRESENTATION LAYER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ React Native â”‚              â”‚   WebView    â”‚       â”‚
â”‚  â”‚  Components  â”‚              â”‚  (HTML/Leaflet)      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         BUSINESS LOGIC LAYER                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  React Hooks (useState, useEffect)       â”‚         â”‚
â”‚  â”‚  - State Management                      â”‚         â”‚
â”‚  â”‚  - Location Handling                     â”‚         â”‚
â”‚  â”‚  - ETA Calculation                       â”‚         â”‚
â”‚  â”‚  - Route Interpolation                   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         COMMUNICATION LAYER                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Paho MQTT Client                        â”‚         â”‚
â”‚  â”‚  - Connect/Disconnect                    â”‚         â”‚
â”‚  â”‚  - Publish/Subscribe                     â”‚         â”‚
â”‚  â”‚  - Message Handling                      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         NATIVE APIs LAYER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  - expo-location (GPS)                   â”‚         â”‚
â”‚  â”‚  - Permissions (Android/iOS)             â”‚         â”‚
â”‚  â”‚  - WebView Bridge                        â”‚         â”‚
â”‚  â”‚  - AsyncStorage                          â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         EXTERNAL SERVICES LAYER                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  - Broker MQTT (Mosquitto)               â”‚         â”‚
â”‚  â”‚  - OpenStreetMap (Tiles)                 â”‚         â”‚
â”‚  â”‚  - Leaflet CDN                           â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ”„ Diagrama de Secuencia

### Flujo Completo: Inicio a Llegada

```
Repartidor    App-Repartidor    Broker MQTT    App-Albergue    Albergue
    â”‚               â”‚                â”‚              â”‚            â”‚
    â”‚â”€Abre Appâ”€â”€â”€â”€â”€>â”‚                â”‚              â”‚            â”‚
    â”‚               â”‚                â”‚              â”‚            â”‚
    â”‚<â”€Solicitaâ”€â”€â”€â”€â”¤                â”‚              â”‚            â”‚
    â”‚  UbicaciÃ³n   â”‚                â”‚              â”‚            â”‚
    â”‚               â”‚                â”‚              â”‚            â”‚
    â”‚â”€Aceptaâ”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚              â”‚            â”‚
    â”‚               â”‚                â”‚              â”‚            â”‚
    â”‚â”€Ingresa nombreâ””â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚              â”‚            â”‚
    â”‚                        â”œâ”€Conecta a Broker    â”‚            â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚<â”€Abre Mapaâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚              â”‚            â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚                        â”œâ”€Publica ubicaciÃ³n   â”‚            â”‚
    â”‚                        â”‚   [lat, lng]â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”€Recibe     â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚                        â”‚       â”‚              â”œâ”€Procesa   â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚                        â”‚       â”‚              â”œâ”€Calcula   â”‚
    â”‚                        â”‚       â”‚              â”‚ ETA y rutaâ”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚                        â”‚   Publica ruta    â”‚
    â”‚                        â”‚ [polyline, eta]   â”‚
    â”‚<â”€Publica rutaâ”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚              â”‚
    â”‚  Recibe ruta           â”‚       â”‚              â”‚            â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚<â”€Visualiza ruta       â”¤       â”‚              â”‚            â”‚
    â”‚  Navega a destino      â”‚       â”‚              â”‚            â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚                        â”œâ”€Publica ubicaciÃ³n   â”‚            â”‚
    â”‚                        â”‚   [lat, lng]â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”€Recibe     â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚                        â”‚       â”‚              â”œâ”€Recalcula â”‚
    â”‚                        â”‚       â”‚              â”‚ ETA        â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚                        â”‚   Publica ruta     â”‚
    â”‚                        â”‚ [actualizada]      â”‚
    â”‚<â”€Ruta actualizadaâ”€â”€â”€â”€â”€â”€â”¤       â”‚              â”‚            â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚                   [ContinÃºa cada 5 segundos]             â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚â”€ Llega al albergue     â”‚       â”‚              â”‚            â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚â”€Presiona Cerrarâ”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚              â”‚            â”‚
    â”‚                        â”œâ”€Desconecta        â”‚            â”‚
    â”‚                        â”‚       â”‚              â”‚            â”‚
    â”‚<â”€Vuelve al menÃºâ”€â”€â”€â”€â”€â”€â”€â”¤       â”‚              â”‚            â”‚
```

## ðŸ“‰ Diagrama de Flujo

### Flujo App-Albergue

```
                    START
                      â”‚
                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Mostrar MenÃº    â”‚
            â”‚ Principal       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚            â”‚
   [Seleccionar   â”‚ [UbicaciÃ³n   â”‚
    Albergue A]   â”‚  Actual]     â”‚
        â”‚            â”‚            â”‚
        â–¼            â–¼            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Obtener UbicaciÃ³n          â”‚
   â”‚ (Lat, Lng)                 â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Conectar MQTT              â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚      â”‚
       [OK]    [FALLO]
          â”‚      â”‚
          â–¼      â–¼
    Conectado   Error
          â”‚      â”‚
          â””â”€â”€â”¬â”€â”€â”€â”˜
             â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Mostrar Mapa + Modal       â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Esperar mensajes MQTT      â”‚
   â”‚ (paquetes/posicion)        â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                â”‚
[Mensaje      [Timeout]
Recibido]      â”‚
   â”‚            â–¼
   â–¼      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ Mostrar Errorâ”‚
â”‚Procesarâ”‚â”‚              â”‚
â”‚datos   â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚        â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Calcular ETA      â”‚
â”‚Calcular Ruta     â”‚
â”‚Actualizar Modal  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Publicar Ruta MQTTâ”‚
â”‚(paquetes/ruta)   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Â¿Presionar Cerrar?        â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚
   [NO]           [SÃ]
     â”‚              â”‚
     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚Desconectar MQTTâ”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚Mostrar MenÃº  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Flujo App-Repartidor

```
                    START
                      â”‚
                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Mostrar MenÃº    â”‚
            â”‚ (Nombre Input)  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
    [Ingresa         [Presiona
     Nombre]        Iniciar Viaje]
        â”‚                         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Solicitar Permiso  â”‚
        â”‚ de UbicaciÃ³n       â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚       â”‚
        [OK] â”‚   [DENEGADO]
             â”‚       â”‚
             â–¼       â–¼
          OK      Error
             â”‚       â”‚
             â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Conectar MQTT      â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
               â”‚      â”‚
            [OK]    [FALLO]
               â”‚      â”‚
               â–¼      â–¼
           Conectado  Error
               â”‚      â”‚
               â””â”€â”€â”¬â”€â”€â”€â”˜
                  â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Mostrar Mapa +     â”‚
        â”‚ Modal Inferior     â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Obtener UbicaciÃ³n  â”‚
        â”‚ (cada 5 segundos)  â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Publicar ubicaciÃ³n â”‚
        â”‚ MQTT               â”‚
        â”‚ paquetes/posicion  â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                â”‚
[Suscribir a    [Timeout]
  paquetes/     â”‚
  ruta]         â–¼
     â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼      â”‚ Mostrar  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ Error    â”‚
â”‚Recibir â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚Ruta    â”‚
â”‚Destino â”‚
â”‚ETA     â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Visualizar en   â”‚
â”‚Mapa Leaflet    â”‚
â”‚- Marcador dest â”‚
â”‚- Polyline      â”‚
â”‚- ETA           â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Â¿LlegÃ³ a Destino?â”‚
â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
   â”‚        â”‚
 [NO]    [SÃ]
   â”‚        â”‚
   â”‚        â–¼
   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   â”‚Presionar     â”‚
   â”‚   â”‚Cerrar        â”‚
   â”‚   â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚      â”‚
   â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚           â”‚
          â–¼           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Desconectar MQTT     â”‚
    â”‚ Limpiar Recursos     â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Mostrar MenÃº â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ§© Diagrama de Componentes

### App-Albergue - JerarquÃ­a de Componentes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ App (Componente Principal)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  if (!viajeActivo)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ MenuView                   â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚ - ScrollView               â”‚       â”‚
â”‚  â”‚   â”œâ”€ AlbergueButton[]      â”‚       â”‚
â”‚  â”‚   â”‚  â”œâ”€ Text (nombre)      â”‚       â”‚
â”‚  â”‚   â”‚  â””â”€ Text (coords)      â”‚       â”‚
â”‚  â”‚   â””â”€ UbicacionButton       â”‚       â”‚
â”‚  â”‚      â”œâ”€ Text               â”‚       â”‚
â”‚  â”‚      â””â”€ onPress handler    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                        â”‚
â”‚  if (viajeActivo)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ MapView                    â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚ - WebView                  â”‚       â”‚
â”‚  â”‚   â””â”€ HTML Leaflet          â”‚       â”‚
â”‚  â”‚      â”œâ”€ L.map              â”‚       â”‚
â”‚  â”‚      â”œâ”€ L.tileLayer        â”‚       â”‚
â”‚  â”‚      â”œâ”€ L.marker           â”‚       â”‚
â”‚  â”‚      â””â”€ L.polyline         â”‚       â”‚
â”‚  â”‚                            â”‚       â”‚
â”‚  â”‚ - ModalOverlay             â”‚       â”‚
â”‚  â”‚   â”œâ”€ CloseButton           â”‚       â”‚
â”‚  â”‚   â”œâ”€ MqttStatus            â”‚       â”‚
â”‚  â”‚   â”œâ”€ AlbergueInfo Section  â”‚       â”‚
â”‚  â”‚   â”œâ”€ RepartidorInfo Sectionâ”‚       â”‚
â”‚  â”‚   â””â”€ EtaDisplay            â”‚       â”‚
â”‚  â”‚                            â”‚       â”‚
â”‚  â”‚ - StyleSheet               â”‚       â”‚
â”‚  â”‚   â”œâ”€ menuContainer         â”‚       â”‚
â”‚  â”‚   â”œâ”€ albergueButton        â”‚       â”‚
â”‚  â”‚   â”œâ”€ modalOverlay          â”‚       â”‚
â”‚  â”‚   â”œâ”€ modalContent          â”‚       â”‚
â”‚  â”‚   â””â”€ ... (20+ estilos)     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ”€ Diagrama de Estados

### Estados en App-Albergue

```
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   INITIAL   â”‚
                â”‚ (viajeActivo: false)
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                         â”‚
                    [Seleccionar
                     Albergue]
                         â”‚
                         â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ SELECCIONADO     â”‚
                â”‚ (viajeActivo: false,
                â”‚  albergue: set)
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                    [Activar viaje]
                         â”‚
                         â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ CONECTANDO       â”‚
                â”‚ (viajeActivo: true,
                â”‚  mqttConnected:   
                â”‚  false)
                â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”˜
                   â”‚              â”‚
              [OK] â”‚          [ERROR]
                   â”‚              â”‚
                   â–¼              â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚CONECTADO   â”‚   â”‚ERROR     â”‚
            â”‚mqttConnected  â”‚          â”‚
            â”‚: true)     â”‚   â”‚          â”‚
            â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
               â”‚ [Recibe ubicaciÃ³n]â”‚
               â–¼                   â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
            â”‚MONITOREANDOâ”‚         â”‚
            â”‚(Rastreando â”‚         â”‚
            â”‚ repartidor)â”‚         â”‚
            â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
               â”‚ [Actualiza frecuentes]
               â”‚                   â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                   [Presionar Cerrar]
                       â”‚
                       â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚DESCONECTANDOâ”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚INICIAL      â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Estados ConexiÃ³n MQTT

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DISCONNECTED â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚
    [connect()] 
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CONNECTING   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”˜
     â”‚     â”‚
[OK] â”‚ [FAIL]
     â”‚     â”‚
     â–¼     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚CONNECTED   â”‚  ERROR   â”‚
â””â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
   â”‚              â”‚
   â”‚ [subscribe()]â”‚
   â”‚              â”‚
   â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚SUBSCRIBED    â”‚ â”‚  [retry] â”‚
â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
   â”‚       â”‚          â”‚
   â”‚ [msg] â”‚     â””â”€â”€â”€â”€â”€â”˜
   â–¼       â”‚
[Process]  â”‚
   â”‚       â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
       â”‚
   [disconnect()]
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DISCONNECTED â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ“‹ Diagrama ER de Datos

### Entidades y Relaciones (Conceptual)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ALBERGUE        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)          â”‚
â”‚ nombre           â”‚
â”‚ latitude         â”‚
â”‚ longitude        â”‚
â”‚ timestamp        â”‚
â”‚ activo           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    1    â”‚     *
         â”‚  tiene
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  REPARTIDOR      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)          â”‚
â”‚ nombre           â”‚
â”‚ dispositivo_id   â”‚
â”‚ estado           â”‚
â”‚ timestamp_activ. â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    1    â”‚     *
         â”‚  produce
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UBICACION       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)          â”‚
â”‚ repartidor_id(FK)â”‚
â”‚ latitude         â”‚
â”‚ longitude        â”‚
â”‚ precision        â”‚
â”‚ timestamp        â”‚
â”‚ altitude         â”‚
â”‚ speed            â”‚
â”‚ heading          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    1    â”‚     *
         â”‚  describe
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RUTA            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)          â”‚
â”‚ repartidor_id(FK)â”‚
â”‚ albergue_id (FK) â”‚
â”‚ puntos           â”‚
â”‚ distancia_km     â”‚
â”‚ eta_minutos      â”‚
â”‚ timestamp        â”‚
â”‚ estado           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸš€ Diagrama de Despliegue

### Arquitectura de Despliegue

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   INTERNET / Cloud                       â”‚
â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚                                           â”‚
   â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚                          â”‚
   â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Play Store    â”‚   â”‚   APP Store     â”‚
â”‚  (Android APK) â”‚   â”‚   (iOS App)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                            â”‚
    â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dispositivo A â”‚       â”‚  Dispositivo B   â”‚
â”‚ (Repartidor1) â”‚       â”‚  (Albergue1)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - Android 8+  â”‚       â”‚  - Android 8+    â”‚
â”‚ - App RepartIDâ”‚       â”‚  - App Albergue  â”‚
â”‚ - MQTT Client â”‚       â”‚  - MQTT Client   â”‚
â”‚ - GPS Sensor  â”‚       â”‚  - GPS Sensor    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  WebSocket (Port 9001) â”‚
         â”‚  (Local Network)       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   VPS / Local Server    â”‚
        â”‚ (192.168.1.137)         â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ - Mosquitto MQTT Broker â”‚
        â”‚   - Puerto 1883 (TCP)   â”‚
        â”‚   - Puerto 9001 (WS)    â”‚
        â”‚                         â”‚
        â”‚ - (Opcional) Base Datos â”‚
        â”‚   - HistÃ³rico de rutas  â”‚
        â”‚   - Analytics           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Stack de Despliegue (Detallado)

```
APLICACIONES
â”œâ”€ App Albergue
â”‚  â”œâ”€ React Native 0.81.5
â”‚  â”œâ”€ Expo 54.0.23
â”‚  â”œâ”€ MQTT Client (Paho)
â”‚  â””â”€ Leaflet.js (Maps)
â”‚
â””â”€ App Repartidor
   â”œâ”€ React Native 0.81.5
   â”œâ”€ Expo 54.0.23
   â”œâ”€ MQTT Client (Paho)
   â””â”€ Leaflet.js (Maps)

COMUNICACIÃ“N
â”œâ”€ Protocolo MQTT 3.1.1
â”œâ”€ WebSocket (RFC 6455)
â””â”€ Port 9001

SERVICIOS
â”œâ”€ Mosquitto MQTT Broker
â”œâ”€ OpenStreetMap API
â””â”€ Leaflet CDN

DATOS
â”œâ”€ GPS Coordinates
â”œâ”€ Route Polylines
â””â”€ ETA Calculations

PLATAFORMAS
â”œâ”€ Android SDK 31+
â”œâ”€ iOS 12.0+
â””â”€ Web (Experimental)
```

## ðŸ”€ Diagrama de InteracciÃ³n MQTT

```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Repartidor  â”‚
         â”‚    (App)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                â”‚ publica
                â”‚ cada 5s
                â”‚
         {latitude, longitude}
                â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                        â”‚
    â–¼                        â–¼
paquetes/              (broker almacena)
posicion               
    â”‚                        
    â”‚ suscriptor             
    â”‚                        
    â–¼                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Albergue 1 â”‚        â”‚  Albergue 2    â”‚
â”‚   (App)     â”‚        â”‚   (App)        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ recibe                 â”‚ recibe
       â”‚                        â”‚
       â”œâ”€ Procesa ubicaciÃ³n     â”œâ”€ Procesa ubicaciÃ³n
       â”‚                        â”‚
       â”œâ”€ Calcula ETA           â”œâ”€ Calcula ETA
       â”‚                        â”‚
       â”œâ”€ Calcula ruta          â”œâ”€ Calcula ruta
       â”‚                        â”‚
       â””â”€ publica ruta          â””â”€ publica ruta
           en                      en
         paquetes/ruta         paquetes/ruta
           â”‚                     â”‚
           â”‚                     â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚            â”‚        â”‚             â”‚
    â–¼            â–¼        â–¼             â–¼
Repartidor   (broker)  Repartidor   (broker)
 (App 1)   almacena    (App 2)   almacena
 suscribe              suscribe
```

---

**Ãšltima actualizaciÃ³n**: Noviembre 2025
**VersiÃ³n**: 1.0.0

---

## ðŸ“ Notas sobre Diagramas

- **ASCII Art**: Los diagramas estÃ¡n en formato ASCII para legibilidad en Markdown
- **Mermaid**: Para mejor visualizaciÃ³n, considera usar:
  ```markdown
  graph TD
      A[App] --> B[MQTT]
      B --> C[Broker]
  ```
- **Draw.io**: Alternativa para diagramas mÃ¡s detallados
- **Lucidchart**: Herramienta profesional de diagramas

## ðŸ”„ Actualizaciones de Diagramas

Cuando hagas cambios en la arquitectura:
1. Actualiza los diagramas ASCII
2. Regenera cualquier formato de imagen
3. Actualiza leyendas y referencias cruzadas
4. Actualiza versiÃ³n del documento

